<!--------------- Course Panel ---------------------- -->
<div class='row' style="margin:0;color: #1C383F; background-color:#fff7ec"  ng-show='inspectorDisplaySrc==="course"'>
<div class="widget" style="width:48%">
    <div class="header">Statistiques  de
    <select class="btn-xs btn-achievement" ng-model="statSelector">
      <option value="visits">Lecture</option>
      <option value="rs">Séances de lecture</option> 
      <option value="issues">Problèmes de lecture</option>
    </select><br>

    
    </div>
    <div>
    <br/>

        <ul ng-show="statSelector=='visits'">
        <li class='statElement'>Pour la période allant du <b>15 octobre 2015</b> au <b>22 décembre 2015</b>, le cours a été visité par <b>{{context.stats.reading.nusers}} lecteurs.</b> 
                <li class='statElement'>En moyenne, le nombre de sections lues représente <b>{{context.stats.achievement.mean}}%</b> du cours. 
            <!--Le taux médian est de {{context.stats.achievement.median}}%.-->
           <!-- <li class='statElement'>Le temps moyen de la lecture d'une section du cours est de <b>4.5 minutes.</b>-->
            <li class='statElement'>En moyenne, le temps nécessaire pour lire la ttalité du cours est de  <b>130 minutes.</b>            
        </ul>
        <ul ng-show="statSelector=='rs'">
            <li class='statElement'>En moyenne, un lecteur consacre <b>2 séances</b> de lecture pour ce cours. 
                <li class='statElement'>Une séance de lecture est en moyenne composée de <b>{{context.stats.rs.mean_nparts}} sections.</b>
                    <li class='statElement'>Une séance de lecture dure en moyenne <b>{{context.stats.rs.mean_duration}} minutes</b>.
        </ul>
        <ul ng-show="statSelector=='issues'">
            <li class='statElement'>Un total de <b>{{context.stats.issues.all}} problèmes</b> détectés dont:
            <ul>
                <li class='statElement'><b>{{context.stats.issues.readings}}</b> relatifs à la lecture
                    <li class='statElement'><b>{{context.stats.issues.rereading}}</b> relatifs à la relecture
                    <li class='statElement'><b>{{context.stats.issues.transition}}</b> relatifs à la navigation
                    <li class='statElement'><b>{{context.stats.issues.stop}}</b> relatifs aux arrêts
            </ul>


        </ul>
    </div>
    

</div>


<div class="widget" style="width:48%; ">
    <div class="header">Top / Flop des 
    <select class="btn-xs btn-achievement" ng-model="topElementSelector">
      <option value="sections">Sections</option> <!-- not selected / blank option -->
      <option value="chapters">Chapitres</option> <!-- interpolation -->
    </select>   
    par nombre de
    <select class="btn-xs btn-achievement"  ng-model="topSelector">
      <option value="Actions_tx">Visites</option> <!-- not selected / blank option -->
      <option value="Readers">Lecteurs</option> <!-- interpolation -->
    </select> 

   
         
</div>
      <br/>

    <div ng-show="topElementSelector=='tomes'">    

        <ol ng-show="topSelector=='Actions_tx'">
        <li role='button' ng-click='triggerClick($event)' class='topElement' ng-repeat="top in context.Tops.Tomes.Actions_tx" data-path={{top.route}}  ng-mouseover="triggerHover($event)" onmouseout='stopHover()' >{{top.title}} 
        </ol>

        <ol ng-show="topSelector=='Readers'">
        <li role='button' ng-click='triggerClick($event)' class='topElement' ng-repeat="top in context.Tops.Tomes.Readers" data-path={{top.route}}  ng-mouseover="triggerHover($event)" onmouseout='stopHover()' >{{top.title}} 
        </ol>

        <ol ng-show="topSelector=='RS_nb'">
        <li role='button' ng-click='triggerClick($event)' class='topElement' ng-repeat="top in context.Tops.Tomes.RS_nb" data-path={{top.route}}  ng-mouseover="triggerHover($event)" onmouseout='stopHover()' >{{top.title}} 
        </ol>
    </div>

    <div ng-show="topElementSelector=='chapters'">    
        <ol ng-show="topSelector=='Actions_tx'">
        <li role='button' ng-click='triggerClick($event)' class='topElement' ng-repeat="top in context.Tops.Chapters.Actions_tx" data-path={{top.route}}  ng-mouseover="triggerHover($event)" onmouseout='stopHover()' >{{top.title}} 
        </ol>

        <ol ng-show="topSelector=='Readers'">
        <li role='button' ng-click='triggerClick($event)' class='topElement' ng-repeat="top in context.Tops.Chapters.Readers" data-path={{top.route}}  ng-mouseover="triggerHover($event)" onmouseout='stopHover()' >{{top.title}} 
        </ol>

        <ol ng-show="topSelector=='RS_nb'">
        <li role='button' ng-click='triggerClick($event)' class='topElement' ng-repeat="top in context.Tops.Chapters.RS_nb" data-path={{top.route}}  ng-mouseover="triggerHover($event)" onmouseout='stopHover()' >{{top.title}} 
        </ol>
        <hr/>
            <ol ng-show="topSelector=='Actions_tx'" start="9">
        <li role='button' ng-click='triggerClick($event)' class='topElement' ng-repeat="flop in context.Flops.Chapters.Actions_tx" data-path={{flop.route}}  ng-mouseover="triggerHover($event)" onmouseout='stopHover()' >{{flop.title}} 
        </ol>

        <ol ng-show="topSelector=='Readers'" start="9">
        <li role='button' ng-click='triggerClick($event)' class='topElement' ng-repeat="flop in context.Flops.Chapters.Readers" data-path={{flop.route}}  ng-mouseover="triggerHover($event)" onmouseout='stopHover()' >{{flop.title}} 
        </ol>

        <ol ng-show="topSelector=='RS_nb'" start="9">
        <li role='button' ng-click='triggerClick($event)' class='topElement' ng-repeat="flop in context.Flops.Chapters.RS_nb" data-path={{flop.route}}  ng-mouseover="triggerHover($event)" onmouseout='stopHover()' >{{flop.title}} 
        </ol>
    </div>
    <div ng-show="topElementSelector=='sections'">    
        <ol ng-show="topSelector=='Actions_tx'">
        <li role='button' ng-click='triggerClick($event)' class='topElement' ng-repeat="top in context.Tops.Sections.Actions_tx" data-path={{top.route}}  ng-mouseover="triggerHover($event)" onmouseout='stopHover()' >{{top.title}} 
        </ol>

        <ol ng-show="topSelector=='Readers'">
        <li role='button' ng-click='triggerClick($event)' class='topElement' ng-repeat="top in context.Tops.Sections.Readers" data-path={{top.route}}  ng-mouseover="triggerHover($event)" onmouseout='stopHover()' >{{top.title}} 
        </ol>

        <ol ng-show="topSelector=='RS_nb'">
        <li role='button' ng-click='triggerClick($event)' class='topElement' ng-repeat="top in context.Tops.Sections.RS_nb" data-path={{top.route}}  ng-mouseover="triggerHover($event)" onmouseout='stopHover()' >{{top.title}} 
        </ol>

        <hr/>

        <ol ng-show="topSelector=='Actions_tx'" start="24">
        <li role='button' ng-click='triggerClick($event)' class='topElement' ng-repeat="flop in context.Flops.Sections.Actions_tx" data-path={{flop.route}}  ng-mouseover="triggerHover($event)" onmouseout='stopHover()' >{{flop.title}} 
        </ol>

        <ol ng-show="topSelector=='Readers'" start="24">
        <li role='button' ng-click='triggerClick($event)' class='topElement' ng-repeat="flop in context.Flops.Sections.Readers" data-path={{flop.route}}  ng-mouseover="triggerHover($event)" onmouseout='stopHover()' >{{flop.title}} 
        </ol>

        <ol ng-show="topSelector=='RS_nb'" start="24">
        <li role='button' ng-click='triggerClick($event)' class='topElement' ng-repeat="flop in context.Flops.Sections.RS_nb" data-path={{flop.route}}  ng-mouseover="triggerHover($event)" onmouseout='stopHover()' >{{flop.title}} 
        </ol>
    </div>
</div>


 <d3-chart data='context.d3.stats' d3opts='{type:"global",issueCode:"all"}'></d3-chart>
 
</div>

<!--------------- Section Panel ---------------------- -->
<div class='row' style="margin:10px;color: #1C383F; " ng-show='inspectorDisplaySrc==="section"'>
<table class='col-lg-6 coreada-box' class="btn-group">
<tr ng-model="sectionPstatSelector">
<tr><td class='componentInfo' tabindex="0" role='button' aria-pressed="false" ng-model="$parent.sectionPstatSelector" uib-btn-radio="'Actions_tx'"><span class="blue">{{observedElt.Actions_tx}}</span> des visites sur le cours ont été observées sur {{observedElt.typeTxt}} </td></tr>   

    <tr><td class='componentInfo' tabindex="0" role='button' aria-pressed="false" ng-model="$parent.sectionPstatSelector" uib-btn-radio="'Readers_tx'"><span class="blue">{{observedElt.nbUsers}}</span> des lecteurs du cours ont visité cette section </td></tr>

    
    <tr><td class='componentInfo ' tabindex="0" role='button' aria-pressed="false" ng-model="$parent.sectionPstatSelector" uib-btn-radio="'mean.duration'"><span class="blue">{{observedElt.meanTime}}</span> est le temps moyen de lecture dans cette section. </td></tr>
    <tr><td class='componentInfo' tabindex="0" role='button' aria-pressed="false" ng-model="$parent.sectionPstatSelector" uib-btn-radio="'rereadings_tx'"><span class="blue">{{observedElt.meanRereads}}</span> des lectures de cette section sont des <b>relectures</b>.</td></tr>
    <tr><td class='componentInfo' tabindex="0" role='button' aria-pressed="false" ng-model="$parent.sectionPstatSelector" uib-btn-radio="'rupture_tx'"><span class="blue">{{observedElt.meanStops}}</span> des arrêts définitifs de la lecture se passent sur cette section</td></tr>


    <tr><td class='componentInfo' tabindex="0" role='button' aria-pressed="false" ng-model="$parent.sectionPstatSelector" uib-btn-radio="'provenance'">
    Le taux des arrivées linéaires (depuis la section précédente) est de  <span class="blue">{{observedElt.provLinearity}}</span>.  </td></tr>

    <tr><td class='componentInfo' tabindex="0" role='button' aria-pressed="false" ng-model="$parent.sectionPstatSelector" uib-btn-radio="'destination'">
    Le taux des départs linéaires (vers la section suivante) est de  <span class="blue">{{observedElt.destLinearity}}</span>.   </td></tr>
    </td></tr>
    
    
    </table>

    <div class='col-lg-6 coreada-box'>
    <div class='chart-title'><u>{{graphTitle}}</u></div>

    <d3-chart data='context.d3' d3opts='{type:"inspector",elementType:"part",elementId:observedElt.id,issueCode:$parent.sectionPstatSelector}'></d3-chart>
    </div>
</div>


<!--------------- Component Panel ---------------------- -->
<div class='row' style="margin:10px;color: #1C383F; " ng-show='inspectorDisplaySrc==="component"'>
<table class='col-lg-6 coreada-box' class="btn-group">
<tr ng-model="sectionPstatSelector">
    <tr><td class='componentInfo' tabindex="0" role='button' aria-pressed="false" ng-model="$parent.sectionPstatSelector" uib-btn-radio="'Actions_tx'"><span class="blue">{{observedElt.Actions_tx}}</span> des visites sur le cours ont été observées sur {{observedElt.typeTxt}} </td></tr>   
        <tr><td class='componentInfo' tabindex="0" role='button' aria-pressed="false" ng-model="$parent.sectionPstatSelector" uib-btn-radio="'Readers_tx'"><span class="blue">{{observedElt.nbUsers}}</span> des lecteurs du cours ont visité {{observedElt.typeTxt}} </td></tr>
    <tr><td class='componentInfo ' tabindex="0" role='button' aria-pressed="false" ng-model="$parent.sectionPstatSelector" uib-btn-radio="'mean.duration'"><span class="blue">{{observedElt.meanTime}}</span> est le temps moyen de lecture de {{observedElt.typeTxt}}. </td></tr>
    <tr><td class='componentInfo' tabindex="0" role='button' aria-pressed="false" ng-model="$parent.sectionPstatSelector" uib-btn-radio="'rereadings_tx'"><span class="blue">{{observedElt.meanRereads}}</span> des lectures de {{observedElt.typeTxt}} sont des <b>relectures</b>.</td></tr>
    <tr><td class='componentInfo' tabindex="0" role='button' aria-pressed="false" ng-model="$parent.sectionPstatSelector" uib-btn-radio="'rupture_tx'"><span class="blue">{{observedElt.meanStops}}</span> des arrêts définitifs de la lecture se passent sur {{observedElt.typeTxt}}</td></tr>
    <tr><td class='componentInfo' tabindex="0" role='button' aria-pressed="false" ng-model="$parent.sectionPstatSelector" uib-btn-radio="'provenance'">
    Au sein de {{observedElt.typeTxt}}, le taux des arrivées linéaires vers ses sections (depuis les section précédentes) est de  <span class="blue">{{observedElt.provLinearity}}</span>.  </td></tr>
    <tr><td class='componentInfo' tabindex="0" role='button' aria-pressed="false" ng-model="$parent.sectionPstatSelector" uib-btn-radio="'destination'">
    Au sein de {{observedElt.typeTxt}}, le taux des départs linéaires depuis ses sections (vers les section suivantes) est de  <span class="blue">{{observedElt.destLinearity}}</span>. </td></tr>

    </tr>
    </table>

    <div class='col-lg-6 coreada-box'>
        <div class='chart-title'><u>{{graphTitle}}</u></div>
    

    <d3-chart data='context.d3' d3opts='{type:"inspector",elementType:observedElt.type,elementId:observedElt.id,issueCode:$parent.sectionPstatSelector}'></d3-chart>
    </div>
</div>

<!--------------- Indicator Panel ---------------------- -->
<div class='row' ng-show='inspectorDisplaySrc==="indicator"'>
<div class='col-lg-12' ng-show="indicatorInspectorShow!='Transition'">    
   <select class="btn-xs btn-achievement" ng-model="globalChartSelector">
      <option value="Actions_tx" ng-show="indicatorInspectorShow=='Readings'">Taux de visites</option>
      <option value="Readers_tx"ng-show="indicatorInspectorShow=='Readings'">Taux de lecteurs</option>
      <option value="mean.duration" ng-show="indicatorInspectorShow=='Readings'">Durées de lecture</option>      
   
      <option value="rereadings_tx" ng-show="indicatorInspectorShow=='Rereading'">Taux de lectures qui sont des relectures</option>
     <!-- <option value="course_readers_rereaders" ng-show="indicatorInspectorShow=='Rereading'">Taux de lecteurs du cours qui sont relecteurs</option>-->
      <option value="part_readers_rereaders" ng-show="indicatorInspectorShow=='Rereading'">Taux de lecteurs qui sont également relecteurs</option>  

      <option value="rupture_tx" ng-show="indicatorInspectorShow=='Stop'">Taux de fin de séances</option> <option value="norecovery_tx" ng-show="indicatorInspectorShow=='Stop'">Taux de fin définitive de la lecture</option>
      <option value="recoveries" ng-show="indicatorInspectorShow=='Stop'">Sections de reprises</option>


       

    </select><br>
  


    <span ng-show="globalChartSelector=='recoveries'" style="padding:10px">Lors d’une nouvelle séance lecture, la section sur laquelle la lecture reprend est : dans <b>10%</b> des cas sur la section d’arrêt, dans <b>32%</b> des cas sur la section suivante, dans <b>15%</b> des cas sur une section plus en avant, dans <b>7%</b> des cas sur la section précédente et dans <b>30%</b> des cas sur une section plus en arrière </span>
    <d3-chart data='context.d3' d3opts='{type:"global",issueCode:globalChartSelector, elementType:elementTypeSelector}'></d3-chart>

    </div>
<div class='col-lg-12' ng-show="indicatorInspectorShow=='Transition'" >
<div class='col-lg-6'>
<h4>Sections de provenance</h4>

    <d3-chart data='context.d3' d3opts='{type:"global",issueCode:"provenance", elementType:elementTypeSelector}'>
    </d3-chart>
</div>
<div class='col-lg-6'>
<h4>Sections de destination</h4>
    <d3-chart data='context.d3' d3opts='{type:"global",issueCode:"destination", elementType:elementTypeSelector}'>
    
    </d3-chart>
</div>
</div>
</div>


<!--------------- Important issues Panel ---------------------- -->
<perfect-scrollbar id="inspectorScroller" class="inspectorScroller" wheel-propagation="true" wheel-speed="10" min-scrollbar-length="20" ng-show='inspectorDisplaySrc==="important-issue"'>
<div class='row' id="scrollCont" style="margin:0;color: #1C383F; background-color:#fff7ec" >  
 
<div class="errors-display" >  

<div class="inspector-item"  data-fact={{context.importantFact._id}} multiple   data-path={{context.importantFact.route}}@{{context.importantFact.classof}}>

  <uib-accordion close-others="oneAtATime" >
   <uib-accordion-group is-open="status.open" class='inspector-issue'>
      <uib-accordion-heading>
      <i class="pull-left glyphicon" ng-class="{'glyphicon-chevron-down': status.open, 'glyphicon-chevron-right': !status.open}"></i> <b>{{context.importantFact.name}} </b>  pour la section <b>{{context.importantFact.section}} </b> 
      </uib-accordion-heading>
      <table style="table-layout: fixed;">
      <td style="width: 50%">
      <span class='factDescription'>{{context.importantFact.description}} </span>
    </td>
    <td>
      <h4>{{context.importantFact.d3.title}}</h4>
      <d3-chart data='context.importantFact.d3' d3opts='{type:"fact",issueCode:context.importantFact.issueCode, issueClass:context.importantFact.classof}'></d3-chart>
    </td>
    </table>
    </uib-accordion-group>
  </uib-accordion>

  <uib-accordion close-others="oneAtATime" class="hint-heading">
   <uib-accordion-group is-open="status.open" class='inspector-hint'>
      <uib-accordion-heading >
      <i class="pull-left glyphicon" ng-class="{'glyphicon-chevron-down': status.open, 'glyphicon-chevron-right': !status.open}">
      
      </i> <em>Suggestion: </em> <span>{{context.importantFact.suggestion_title}} </span> <button class="btn btn-primary btn-xs pull-right" ng-click="editSuggestion($event,context.importantFact.suggestion_title)"  data-path={{context.importantFact.route}}><span class="glyphicon glyphicon-ok" ></span>Définir comme tâche</button> 
      </uib-accordion-heading>
      <table style="table-layout: fixed;width:100%; padding:10px">
      <td style="width: 100%">
      <span class='suggestDescription'>{{context.importantFact.suggestion_content}}</span>
    </td>
  </table>
    </uib-accordion-group>
  </uib-accordion>
</div>

</div>

</div>
</perfect-scrollbar>

<!--------------- Issue Panel ---------------------- -->
<perfect-scrollbar id="inspectorScroller" class="inspectorScroller" wheel-propagation="true" wheel-speed="10" min-scrollbar-length="20" ng-show='inspectorDisplaySrc==="issues"'>
<div class='row' id="scrollCont" style="margin:0;color: #1C383F; background-color:#fff7ec" >  
 
<div class="errors-display" >  
<!--<div class="errors-display" >  -->    

<div class="inspector-item"  ng-repeat="fact in context.Facts" data-fact={{fact._id}} multiple  ng-click='triggerFactClick($event)' data-path={{fact.route}}@{{fact.classof}}>
<!--<div class="inspector-item" ng-repeat="fact in focusStudy.studiedElt.facts" multiple>-->

  <uib-accordion close-others="oneAtATime" >
   <uib-accordion-group is-open="status.open" class='inspector-issue'>
      <uib-accordion-heading>
      <i class="pull-left glyphicon" ng-class="{'glyphicon-chevron-down': status.open, 'glyphicon-chevron-right': !status.open}"></i> <b>{{fact.name}} </b>  
      <!--<button class="btn btn-primary btn-xs pull-right " ng-click="createTask($event);" onclick="  document.getElementById('form-controlA').click()" href={{fact.route}}><span class="glyphicon glyphicon-plus"></span>Ajouter une tâche</button>-->
      </uib-accordion-heading>
      <table style="table-layout: fixed;">
      <td style="width: 50%">
      <span class='factDescription'>{{fact.description}} </span>
    </td>
    <td>
      <h4>{{fact.d3.title}}</h4>
      <d3-chart data='fact.d3' d3opts='{type:"fact",issueCode:fact.issueCode, issueClass:fact.classof}'></d3-chart>
    </td>
    </table>
    </uib-accordion-group>
  </uib-accordion>

  <uib-accordion close-others="oneAtATime" class="hint-heading">
   <uib-accordion-group is-open="status.open" class='inspector-hint'>
      <uib-accordion-heading >
      <i class="pull-left glyphicon" ng-class="{'glyphicon-chevron-down': status.open, 'glyphicon-chevron-right': !status.open}">
      
      </i> <em>Suggestion: </em> <span>{{fact.suggestion_title}} </span> <button class="btn btn-primary btn-xs pull-right" ng-click="editSuggestion($event,fact.suggestion_title)" onclick="  document.getElementById('form-controlA').click()" data-path={{fact.route}}><span class="glyphicon glyphicon-ok" ></span>Définir comme tâche</button> 
      </uib-accordion-heading>
      <table style="table-layout: fixed;width:100%; padding:10px">
      <td style="width: 100%">
      <span class='suggestDescription'>{{fact.suggestion_content}}</span>
    </td>
  </table>
    </uib-accordion-group>
  </uib-accordion>
</div>

</div>

</div>
</perfect-scrollbar>

